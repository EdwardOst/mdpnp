MDPNP Camel DDS ICE Demo
===========================

This sample project combines Apache Camel for enterprise integration with RTI
DDS transport for real-time integration. The intent is to demonstrate use open
architecture pluggable design principles with standards based protocols for
medical integration.  It uses data formats consistent with the Integrated 
Clinical Environment ([ICE]) standard.  It can be driven using sample data
generated by the [MDPNP demo-app][mdpnp-demo].

License
-------
All content and accompanying materials are made available under the terms of the
Apache License v2.0 which accompanies this distribution and is available at
http://www.apache.org/licenses/LICENSE-2.0.

Dependencies
------------

### Apache Platform Dependencies

This pom depends on the mdpnp-parent project which in turn imports a pair of
[apache-platform] pom's for dependencyManagement.  This encapsulates and
provides a single point of control for Apache dependencies.  Note that the 
"apache platform" just refers to the fact that the project is intended to
compose multiple apache projects into a logical "platform".  It is not an Apache
community project although it is apache v2 licensed as is all work in this repo.
These projects must be downloaded from git and built locally so that they are
available in your local maven repo.

    git clone https://github.com/EdwardOst/apache-platform.git
    cd apache-platform
    mvn clean install

### ICE Dependencies

A number of IDL files have been used to generate Java classes.  The
PatientDemographic routes require the example-patdemo project.  The MDPNP
demo-app routes require examples-ice.  Both are located in the examples
directory.  These projects will need to be built so that they are available in
your local maven repo.

       <dependency>
            <groupId>com.rti.dds.type</groupId>
            <artifactId>ice-type</artifactId>
            <version>1.0-SNAPSHOT</version>
        </dependency>

        <dependency>
            <groupId>com.rti.dds.type</groupId>
            <artifactId>patdemo-type</artifactId>
            <version>1.0-SNAPSHOT</version>
        </dependency>

### RTI DDS Dependencies

The maven pom for this project uses the maven-dds plugin.  This plugin can be
found in the tools directory.  Like the other dependencies the RTI DDS component
must be built locally so it is available in the local maven repo.  The example
below uses my local fork rather than the origin git repo so it will pick up any
development changes.

Routes
------

There are two sets of routes in the project.
* Patient Demographic
* MDPNP Demo-App DDS Subscriber

### Patient Demographic

Right now it is very simple.  
It generates a sample PatientDemographic java object which it publishes to a
DDS topic.  There is a DDS subscriber to the PatientDemographic topic which logs
it to a corresponding file.  The PatientDemographic class is derived from the
IDL used to define the DDS topic.  This use case represents information that
might originate in an enterprise health record (EHR) system such as VistA which
is being shared with point of care delivery medicall devices such as DocBox at
the bedside.

TODO: 
* generate XSD from IDL
* compare generated XSD to hand-crafted XSD
* add RESTful interface for driving test case using XSD
* drive use case with XML over both REST, SOAP, JMS, and flat file

### MDPNP Demo-App DDS Subscriber

The [MDPNP demo-app][mdpnp-demo] provides a set of simulated medical devices
which publish data using ICE data formats over DDS.  The camel-ice-dds demo
includes a set of subscribers to these routes which will log any received
messages to a file.  Since it uses Camel these messages can be easily routed
to other endpoints if desired, e.g. JMS, REST or SOAP, enrichment, or further
processing.

### Configuration

You may wish to modify the camel routes in the integration.xml file in the 
src/main/resources directory so that they point to an appropriate directory on
your machine.  By default the output path is for c:/mdpnp/ice/xxx where xxx is
the device name.


Build
-----

### Compile and Test

To build this project

    mvn clean install

To run this project with Maven without deploying

    mvn camel:run

Once the routes are running, run the MDPNP demo-app and launch a simulated
medical device.  Check the ice directory to see that the messages are logged to
the appropriate directory.

### Deploy

To generate a stand-alone application using Spring
...

To deploy this project to an Apache Karaf container

    karaf> features:addurl mvn:org.mdpnp.demo/camel-dds-ice/1.0-SNAPSHOT/xml/features
    karaf> features:install camel-dds-ice

To deploy this project to Apache Tomcat
...

For more help see the Apache Camel documentation

    http://camel.apache.org/


[mdpnp-demo]: http://sourceforge.net/projects/mdpnp/
[ICE]: http://www.mdpnp.org/mdice.html
[apache-platform]: https://github.com/EdwardOst/apache-platform
[rti-camel-component]: https://github.com/EdwardOst/rti-camel-component